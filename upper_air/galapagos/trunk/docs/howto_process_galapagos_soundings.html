<html>
<head>
<title>How To: Process Galapagos Sounding Data</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="/dpg/GENERAL/dpg_howto.css">
</head>

<body>
<h1>How To: Process Galapagos Upper Air Sounding Data</h1>
<h2>Table of Contents</h2>
<ol>
	<li><a href="#purpose">Purpose</a></li>
	<li>Previous Versions<ol>
		<li><a href="#version_pacs">PACS</a></li>
		</ol></li>
	<li><a href="#directory">Directory Structure</a></li>
    <li><a href="#getdata">Getting the Data</a></li>
	<li>Processing the Data<ol>
		<li><a href="#converting">Converting the Data</a></li>
		<li><a href="#autoqc">QC'ing the Data</a></li>
		<li><a href="#ebufr">Converting to EBUFR</a></li>
		<li><a href="#codiac">Inserting into the Database</a></li>
		</ol></li>
	<li><a href="#software">Software</a></li>
	<li><a href="#documents">Documentation</a></li>
</ol>
<hr>

<a name="purpose"></a>
<h3>Purpose</h3>
<p>This document contains the instructions on how to process the sounding data from the Galapagos sites into the CLASS format.</p>
<hr>

<h3>Previous Versions</h3>

<a name="version_pacs"></a>
<h4>PACS</h4>
<table>
	<tr><th>Software:</th><td>/work/PACS/upper_air/galapagos/soundings/software</td></tr>
	<tr><th>Raw Data:</th><td></td></tr>
	<tr><th>Final Data:</th><td>/archive/codiac/pacs/soundings/Galapagos</td></tr>
</table>
<hr>

<a name="directory"></a>
<h3>Directory Structure</h3>
<table>
	<tr><th>galapagos/soundings/</th><td>The main directory for the processing.</td></tr>
    <tr><td>archive</td><td>The directory containing the runs for different time periods.  They are grouped together by year and date of the processing.</td></tr>
	<tr><td>docs</td><td>The directory containing documentation about the processing and the data.</td></tr>
	<tr><td>codiac</td><td>The directory where the EBUFR files are placed once they have been created.</td></tr>
	<tr><td>final</td><td>The directory where the QC'ed files are placed once they have been created.</td></tr>
	<tr><td>logs</td><td>The directory where the error/check files from the QC are placed.</td></tr>
    <tr><td>mysql</td><td>The directory where the cfg-dataset file is stored for the data.</td></tr>
	<tr><td>output</td><td>The directory where the CLASS files are put after they are generated.</td></tr>
	<tr><td>raw_data</td><td>The directory where the raw data is stored.</td></tr>
	<tr><td>software</td><td>The directory where the software for the conversion is stored.</td></tr>
</table>
<hr>

<a name="getdata"></a><h3>Getting the Data</h3>
<p>In June 2005, to get the data, we had to email <a href="mailto:Holger.Voemel@noaa.gov">Dr. Holger Voemel</a> at NOAA to send us the data.  He sent us a zip file with the all of the requested data which was placed in <b>/ingest/pacs/GalapagosSoundings</b>.</p>

<h3>Processing the Data</h3>

<a name="convert"></a>
<h4>Converting the Data</h4>
<p>The following is how to convert the raw ASCII data into the CLASS format ready to be QC'ed.</p>
<ol>
	<li>Copy the raw data into the <b>raw_data</b> directory.</li>
	<li>Change to the <b>software</b> directory.</li>
	<li>Run the <b>GALAPAGOS.pl</b> script.  This will convert the raw data to the CLASS format.  (The <b>process_all</b> script could be run as well which will process all of the files and run the QC on them.</li>
</ol>

<a name="autoqc"></a>
<h4>QC'ing the Data</h4>
<p>The following explains how to QC the CLASS formatted sounding data.  This assumes that the auto qc binary is already created.  For more information on the auto qc, see <a href="/dpg/GENERAL/soundings/howto_autoqc_class_soundings.html">How To: AUTO QC CLASS Sounding Data</a>.</p>
<ol>
	<li>Change to the software directory (if you are not already there).</li>
	<li>Edit the <b>autoqc.pl</b> script.
		<p>The variable <b>$AUTOQC</b> needs to be changed to point to the correct autoqc program for the current project.</p>
		</li>
	<li>Run the <b>autoqc.pl</b> script.
		<p>This script takes each file in the <b>output</b> directory, runs the auto qc program on it, and creates a new CLASS file that is placed in the <b>final</b> directory and a check/error log file that is placed in the <b>log</b> directory.</p>
</ol>

<a name="ebufr"></a>
<h4>Converting to EBUFR</h4>
<p>The following explains how to EBUFR the QC'ed CLASS files.  This assumes that the class2ebufr binary file has been generated.  For more information on the EBUFR process, see <a href="/dpg/GENERAL/soundings/howto_ebufr_class_soundings.html">How To: EBUFR CLASS Sounding Data</a>.</p>
<ol>
	<li>Change to the software directory (if you are not already there).
	<li>Make sure the EBUFR configuration files are in the directory.  There should be five (class_file, code_08_021, code_33_254, control_scf.txt, desc_file).  The program will crash without these files.</li>
	<li>Make sure there is a copy of the executable (or a symbolic link to it) in the directory.</li>
	<li>Edit the <b>control_scf.txt</b> file.
		<p>On the 12th line, (two lines above the "END FILE" line) the project name needs to be edited to match the current project.  The rest of the files should remain untouched.</p>
	<li>Edit the <b>create_ebufr_files.pl</b> script.<ol>
		<li>Change the variable: <b>$PROJECT</b> to the name of the current project.</li>
		<li>Change the variable: <b>$PROGRAM</b> to point to the project's version of the class2ebufr program.</li>
		</ol></li>
	<li>Run the <b>create_ebufr_files.pl</b> script.  This will concatonate the CLASS files into day CLASS file which will be used to generate the EBUFR day files.
		<p class="note">Near the end of the file is the pattern for the names of the files that will be generated.  Make sure that the files match the ISS network.</p>
		<p class="note">The script copies the five aforementioned files to the <b>ebufr</b> directory and removes them once the processing is finished.  This is to force all of the intermediate and final files to be saved in the <b>ebufr</b> directory.</p>
</ol>

<a name="codiac"></a>
<h4>Inserting into the Database</h4>
<p>With all of the EBUFR files created, they need to be inserted into the database.  This is a general process and is explained in the document: <a href="/dpg/GENERAL/soundings/howto_insert_ebufred_class_soundings.html">How To: Insert EBUFRed CLASS Sounding Data</a>.</p>
<p>In the <b>mysql</b> directory is the configuration file for the insert script.  If all of the previous steps have been run, nothing should need to be changed in this file except to specify the new files and prevent the older files from being reentered into the database.</p>
<hr>

<a name="software"></a>
<h3>Software</h3>
<p>The following is a list of the contents of the <b>software</b> directory with a brief explanation of the file.</p>
<ul>
	<li><b><a href="../software/GALAPAGOS.pl">GALAPAGOS.pl</a></b>- Convert all of the raw data into the CLASS format.</li>
	<li><b><a href="/cgi-bin/dpg/doc/docperl.cgi?file=/work/NAME/upper_air/galapagos/soundings/software/autoqc.pl">autoqc.pl</a></b>- QC the CLASS files.</li>
	<li><b>class2ebufr</b>- The symbolic link to the CLASS to EBUFR conversion program.</li>
	<li><b>code_08_021</b>- A configuration file for the <b>class2ebufr</b> program.</li>
	<li><b>code_33_254</b>- A configuration file for the <b>class2ebufr</b> program.</li>
	<li><b>control_scf.txt</b>- A configuration file for the <b>class2ebufr</b> program.</li>
	<li><b><a href="/cgi-bin/dpg/doc/docperl.cgi?file=/work/NAME/upper_air/galapagos/soundings/software/create_ebufr_files.pl">create_ebufr_files.pl</a></b>- Convert the QC'ed CLASS files into daily EBUFR files.</li>
	<li><b>desc_file</b>- A configuration file for the <b>class2ebufr</b> program.</li>
</ul>
<hr>

<a name="documents"></a>
<h3>Documentation</h3>
<p>The following are a list of documents that may help with the conversion or are related to the raw data.</p>
<ul>
	<li><a href="/dpg/GENERAL/soundings/howto_autoqc_class_soundings.html">How To: AUTO QC CLASS Sounding Data</a>- The instructions for dealing with the AUTO QC program.</li>
	<li><a href="/dpg/GENERAL/soundings/howto_ebufr_class_soundings.html">How To: EBUFR CLASS Sounding Data</a>- The instructions for dealing with the EBUFR software that relate to CLASS Soundings.</li>
	<li><a href="/dpg/GENERAL/soundings/howto_insert_ebufred_class_soundings.html">How To: Insert EBUFR'ed CLASS Sounding Data into the Database</a>- The instructions on how insert the EBUFR'ed sounding data into the database.</li>
	<li><a href="#">How To: Process Galapagos Sounding Data</a>- This document.</li>
</ul>
<hr>

<p class="foot">Last Updated: June 10, 2005 - Joel Clawson</p>
</body>
</html>
